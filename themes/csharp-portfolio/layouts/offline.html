{{ define "main" }}
<div class="container">
    <section class="error-offline section" aria-labelledby="error-title">
        <div class="error-content">
            <div class="error-code-block" role="img" aria-label="C# code example showing offline connection handling">
                <div class="error-method">
                    <span class="code-keyword" aria-hidden="true">public</span>
                    <span class="code-type" aria-hidden="true">async Task&lt;bool&gt;</span>
                    <span class="code-method">CheckConnection</span><span class="code-parentheses" aria-hidden="true">()</span>
                </div>
                <div class="error-method-body">
                    <span class="code-brace" aria-hidden="true">{</span>
                    <div class="error-method-content">
                        <div class="code-line">
                            <span class="code-keyword" aria-hidden="true">try</span>
                        </div>
                        <div class="code-line code-indent">
                            <span class="code-brace" aria-hidden="true">{</span>
                        </div>
                        <div class="code-line code-indent2">
                            <span class="code-keyword" aria-hidden="true">var</span> <span class="code-variable" aria-hidden="true">response</span> <span class="code-operator" aria-hidden="true">=</span> <span class="code-keyword" aria-hidden="true">await</span> <span class="code-variable" aria-hidden="true">httpClient</span><span class="code-dot" aria-hidden="true">.</span><span class="code-method" aria-hidden="true">GetAsync</span><span class="code-parentheses" aria-hidden="true">(</span><span class="code-string" aria-hidden="true">"/"</span><span class="code-parentheses" aria-hidden="true">)</span><span class="code-semicolon" aria-hidden="true">;</span>
                        </div>
                        <div class="code-line code-indent2">
                            <span class="code-keyword" aria-hidden="true">return</span> <span class="code-variable" aria-hidden="true">response</span><span class="code-dot" aria-hidden="true">.</span><span class="code-property" aria-hidden="true">IsSuccessStatusCode</span><span class="code-semicolon" aria-hidden="true">;</span>
                        </div>
                        <div class="code-line code-indent">
                            <span class="code-brace" aria-hidden="true">}</span>
                        </div>
                        <div class="code-line">
                            <span class="code-keyword" aria-hidden="true">catch</span> <span class="code-parentheses" aria-hidden="true">(</span><span class="code-type" aria-hidden="true">HttpRequestException</span><span class="code-parentheses" aria-hidden="true">)</span>
                        </div>
                        <div class="code-line code-indent">
                            <span class="code-brace" aria-hidden="true">{</span>
                        </div>
                        <div class="code-line code-indent2">
                            <span class="code-comment" aria-hidden="true">// Network connection unavailable</span>
                        </div>
                        <div class="code-line code-indent2">
                            <span class="code-keyword" aria-hidden="true">return</span> <span class="code-keyword" aria-hidden="true">false</span><span class="code-semicolon" aria-hidden="true">;</span>
                        </div>
                        <div class="code-line code-indent">
                            <span class="code-brace" aria-hidden="true">}</span>
                        </div>
                    </div>
                    <span class="code-brace" aria-hidden="true">}</span>
                </div>
            </div>

            <div class="error-details">
                <div class="connection-icon" aria-hidden="true">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 9l2-2 2 2"></path>
                        <path d="M9 17H5a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2h-4"></path>
                        <path d="M21 15l-2-2-2 2"></path>
                        <circle cx="12" cy="17" r="1"></circle>
                        <line x1="8" y1="21" x2="16" y2="21"></line>
                        <line x1="12" y1="17" x2="12" y2="21"></line>
                        <line x1="16" y1="12" x2="20" y2="8"></line>
                        <line x1="20" y1="12" x2="16" y2="8"></line>
                    </svg>
                </div>
                <h1 id="error-title" class="offline-title">Connection Lost</h1>
                <h2 class="error-message">You're Currently Offline</h2>
                <p class="error-description xml-comment">
                    /// Unable to establish network connection. 
                    /// Please check your internet connection and try again.
                </p>

                <div class="connection-status">
                    <div class="status-indicator">
                        <div class="status-dot disconnected"></div>
                        <span class="status-text">No internet connection detected</span>
                    </div>
                </div>

                <div class="error-suggestions">
                    <div class="suggestion-code">
                        <div class="code-comment">// Troubleshooting steps:</div>
                        <div class="suggestion-list">
                            <div class="suggestion-item">
                                <span class="code-comment">• Check your Wi-Fi or ethernet connection</span>
                            </div>
                            <div class="suggestion-item">
                                <span class="code-comment">• Restart your router/modem</span>
                            </div>
                            <div class="suggestion-item">
                                <span class="code-comment">• Disable VPN temporarily</span>
                            </div>
                            <div class="suggestion-item">
                                <span class="code-comment">• Try refreshing the page</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="error-actions">
                    <button onclick="location.reload()" class="btn btn-primary error-btn" aria-describedby="retry-desc">
                        <span class="btn-return-type" aria-hidden="true">async Task</span>
                        <span class="btn-method">Retry</span>
                        <span class="btn-params" aria-hidden="true">()</span>
                    </button>
                    <span id="retry-desc" class="sr-only">Retry loading the page</span>
                    
                    <button onclick="checkOnlineStatus()" class="btn btn-secondary error-btn" aria-describedby="status-desc">
                        <span class="btn-return-type" aria-hidden="true">bool</span>
                        <span class="btn-method">CheckStatus</span>
                        <span class="btn-params" aria-hidden="true">()</span>
                    </button>
                    <span id="status-desc" class="sr-only">Check connection status</span>

                    <a href="/" class="btn btn-outline error-btn" aria-describedby="home-desc">
                        <span class="btn-return-type" aria-hidden="true">void</span>
                        <span class="btn-method">GoHome</span>
                        <span class="btn-params" aria-hidden="true">()</span>
                    </a>
                    <span id="home-desc" class="sr-only">Navigate to home page when online</span>
                </div>
            </div>

            <div class="error-ascii" aria-hidden="true">
                <pre class="ascii-art">
    ╔══════════════════════════════════════╗
    ║           CONNECTION LOST            ║
    ║                                      ║
    ║    ❌ Network: Disconnected          ║
    ║    🔌 Status: Offline                ║
    ║    📡 Signal: Not Available          ║
    ║                                      ║
    ║    Attempting to reconnect...        ║
    ║                                      ║
    ╚══════════════════════════════════════╝
                </pre>
            </div>
        </div>
    </section>
</div>

<script>
function checkOnlineStatus() {
    if (navigator.onLine) {
        alert('✅ Connection restored! Click OK to reload the page.');
        location.reload();
    } else {
        alert('❌ Still offline. Please check your internet connection.');
    }
}

// Auto-detect when connection is restored
window.addEventListener('online', function() {
    const statusDot = document.querySelector('.status-dot');
    const statusText = document.querySelector('.status-text');
    if (statusDot && statusText) {
        statusDot.className = 'status-dot connected';
        statusText.textContent = 'Connection restored! Reloading...';
        setTimeout(() => location.reload(), 2000);
    }
});

// Update status when going offline
window.addEventListener('offline', function() {
    const statusDot = document.querySelector('.status-dot');
    const statusText = document.querySelector('.status-text');
    if (statusDot && statusText) {
        statusDot.className = 'status-dot disconnected';
        statusText.textContent = 'No internet connection detected';
    }
});
</script>

<style>
.error-offline {
    min-height: 70vh;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
}

.error-content {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem;
}

.error-code-block {
    background: var(--code-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    font-family: var(--font-mono);
    text-align: left;
}

.error-method {
    color: var(--code-keyword);
    margin-bottom: 0.5rem;
}

.error-method-body {
    padding-left: 1rem;
}

.error-method-content {
    padding: 0.5rem 0;
    padding-left: 1rem;
}

.code-line {
    margin: 0.3rem 0;
}

.code-indent {
    padding-left: 1rem;
}

.code-indent2 {
    padding-left: 2rem;
}

.error-details {
    margin: 2rem 0;
}

.connection-icon {
    margin: 0 0 1rem 0;
    color: #95a5a6;
}

.offline-title {
    font-size: 3rem;
    font-weight: bold;
    color: var(--text-primary);
    margin: 1rem 0;
    font-family: var(--font-mono);
}

.error-message {
    font-size: 2rem;
    color: var(--text-primary);
    margin: 1rem 0;
}

.error-description {
    font-size: 1.1rem;
    color: var(--text-secondary);
    margin: 1.5rem 0;
    font-style: italic;
}

.connection-status {
    margin: 2rem 0;
}

.status-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin: 1rem 0;
}

.status-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.status-dot.disconnected {
    background-color: #e74c3c;
    animation: pulse-red 2s infinite;
}

.status-dot.connected {
    background-color: #27ae60;
    animation: pulse-green 1s infinite;
}

@keyframes pulse-red {
    0% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(1.2); }
    100% { opacity: 1; transform: scale(1); }
}

@keyframes pulse-green {
    0% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.1); }
    100% { opacity: 1; transform: scale(1); }
}

.status-text {
    font-family: var(--font-mono);
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.error-suggestions {
    margin: 2rem 0;
}

.suggestion-code {
    background: var(--code-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 1rem;
    font-family: var(--font-mono);
    text-align: left;
    max-width: 500px;
    margin: 0 auto;
}

.suggestion-list {
    margin-top: 0.5rem;
}

.suggestion-item {
    margin: 0.3rem 0;
    padding-left: 1rem;
}

.error-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
    margin: 2rem 0;
}

.error-btn {
    min-width: 140px;
}

.error-ascii {
    margin-top: 3rem;
    opacity: 0.7;
}

.ascii-art {
    font-family: var(--font-mono);
    font-size: 0.8rem;
    color: var(--text-secondary);
    overflow-x: auto;
}

@media (max-width: 768px) {
    .offline-title {
        font-size: 2rem;
    }
    
    .error-message {
        font-size: 1.5rem;
    }
    
    .error-actions {
        flex-direction: column;
        align-items: center;
    }
    
    .error-btn {
        width: 100%;
        max-width: 200px;
    }
    
    .ascii-art {
        font-size: 0.6rem;
    }
}
</style>
{{ end }}
